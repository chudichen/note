#### 大致流程

1. URL解析
2. DNS解析
3. TCP连接
4. 处理请求 （后端架构）
5. 接收响应
6. 渲染页面

#### 一、URL解析

#####  地址解析

首先判断你输入的URL是一个合法的URL还是一个待搜索的关键字，并且根据你输入的内容进行自动完成、字符编码等操作。

##### HSTS

由于安全隐患，会使用HSTS强制客户端使用HTTPS访问页面。

##### 其他操作

浏览器还会进行一些额外的操作，比如安全检查、访问限制。

##### 检查缓存

#### 二、DNS查询

##### 基本步骤

浏览器缓存 => 操作系统缓存 => 路由器缓存 => ISP DNS缓存 => 根域名服务器

##### 1. 浏览器缓存

浏览器会先检查是否在缓存中，没有则调用系统库函数进行查询。

##### 2. 操作系统缓存

操作系统也有自己的DNS缓存，但在这之前，会向检查域名是否存在本地的Hosts文件里，没有则向DNS服务器发起查询请求。

##### 3. 路由器缓存

路由器也有自己的缓存。

##### ISP DNS缓存

ISP DNS就是在客户端电脑上设置的首选DNS服务器，他们在大多数情况下都会有缓存。

##### 根域名服务器查询

在面步骤没有缓存的情况下，本地DNS服务器会将请求转发到互联网上的根域，下面这个图很好的诠释了整个流程。

##### 需要注意的点

1. 递归方式：一路查下去中间不反悔，得到最终结果才返回信息（浏览器到本地DNS服务器的过程）
2. 迭代方式，就是本地DNS服务器到根域名服务器查询的方式。
3. 什么是DNS劫持
4. 前端dns-prefetch优化

#### 三、TCP连接

TCP/IP分为四层，再发送数据时，每层都要进行数据封装：

##### 1. 应用层：发送HTTP请求

在前面的不走我们已经得到服务器的IP地址，浏览器会开始构造一个HTTP保温，其中包括：

* 请求报头（RequestHeader）：请求方法、目标地址、遵循的协议等等
* 请求主体（其他参数）

##### 2. 传输层：TCP传输报文

传输层会发起一条到达服务器的TCP连接，为了方便传输，会对数据进行分割（以报文为单位），并标记编号，方便服务器接受时能准确地还原报文信息。

在建立连接前会进行三次握手。

##### 3. 网络层：IP协议查询Mac地址

将数据段打包，并加入源及目标的IP地址，并且负责寻找传输路线。

判断目标地址是否与当前地址处于同一网络中，是的话直接根据Mac地址发送，否则使用路由表查找下一跳地址，以及使用ARP协议查询它的Mac地址。

##### 4.链路层：以太网协议

